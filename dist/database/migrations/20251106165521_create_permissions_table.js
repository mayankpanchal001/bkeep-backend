"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.up = up;
exports.down = down;
/**
 * Create permissions table migration
 * Stores permission information for role-based access control
 */
async function up(knex) {
    await knex.schema.createTable("permissions", (table) => {
        // Primary key - UUID
        // Note: UUID is generated by BaseModel.$beforeInsert() using uuidv4()
        // No database default needed as application handles UUID generation
        table.uuid("id").primary();
        // Permission information
        table.string("name", 255).notNullable().unique();
        table.string("display_name", 255).notNullable();
        table.text("description").nullable();
        table.boolean("is_active").defaultTo(true).notNullable();
        // Timestamps
        table.timestamp("created_at").defaultTo(knex.fn.now()).notNullable();
        table.timestamp("updated_at").defaultTo(knex.fn.now()).notNullable();
        // Soft delete
        table.timestamp("deleted_at").nullable();
        // Indexes
        table.index("name");
        table.index("deleted_at");
        // Composite indexes for common queries
        table.index(["is_active", "deleted_at"]); // For finding active permissions
    });
}
async function down(knex) {
    await knex.schema.dropTableIfExists("permissions");
}
